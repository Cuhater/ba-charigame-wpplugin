\chapter{Konzeption und Design}
\label{chap:concept}
Aufbauend auf der Analyse des Projektkontexts in Kapitel \ref{chap:context} werden in diesem Kapitel die konzeptionellen Überlegungen und das technische Design der Lösung vorgestellt. Ziel ist es, die identifizierten Schwachstellen zu adressieren und eine tragfähige Architektur für die Umsetzung des WordPress-Plugins zu entwerfen. Dabei werden sowohl die Struktur von Backend, Frontend und Helper-Layer als auch die Integration des Gutenberg-Editors konzeptionell beschrieben, um die Basis für die Implementierung in Kapitel \ref{chap:implementation} zu schaffen.
\section{Stakeholderanalyse und Nutzungskontext}
Zuerst werden die Stakeholder und der Nutzungskontext des Projekts Charigame beleuchtet.
Je nach Branche und Geschäftsmodell ergeben sich dabei unterschiedliche Anforderungen an die Funktionalität und den Einsatzkontext.
Eine Übersicht der Stakeholdergruppen ist in Abbildung~\ref{fig:stakeholder} veranschaulicht.
\begin{figure}[H]
    \centering
    \includesvg[width=0.75\textwidth]{images/stakeholder}
    \caption{Stakeholderanalyse Matrix (eigene Darstellung)}
    \label{fig:stakeholder}
\end{figure}

\begin{enumerate}
    \item \textbf{Dienstleistungsunternehmen}

Dienstleistungsunternehmen mit langfristigen Kundenbeziehungen fokussieren sich oft primär auf die Erhaltung ihrer bestehenden Geschäftspartnerschaften.
Hier geht es weniger um die Neukundengewinnung als mehr um die Pflege des bestehenden Kundenstamms.
Eine gamifizierte CSR-Lösung bietet die Möglichkeit die soziale Verantwortung sichtbar zu machen und die Bindung zu stärken.

    \item \textbf{Konzerne}

Großunternehmen nutzen CSR-Maßnahmen strategisch zur Stärkung von Geschäftspartnerschaften und zur Förderung des Markenimages.
Für diese Zielgruppe ist es wichtig, dass die Skalierbarkeit nahtlos und ohne Probleme geschieht.
Charigame kann hier einen innovativen Ansatz bieten, um Mitarbeitende, Partner und die Öffentlichkeit einzubinden.

    \item \textbf{Vermittler}

Unternehmen mit direktem Endkundenkontakt in wettbewerbsintensiven Märkten, profitieren von Alleinstellungsmerkmalen.
Charigame schafft durch seinen spielerischen Ansatz einen niedrigschwelligen Zugang zu CSR-Aktivitäten.
Dies kann die Kundenerfahrung emotional aufwerten, wodurch sich Wettbewerbsvorteile erschließen.

    \item \textbf{Produzenten}

Für produzierende Unternehmen bietet gamifizierte CSR die Möglichkeit, eine emotionale Bindung zwischen Endverbrauchern und der Marke herzustellen.\cite{zhang2025csr}
Spielerisch gestaltete Spendenaktionen lassen sich nahtlos in Marketingkampagnen integrieren.
Diese Aktionen stärken das Markenimage und erhöhen die Reichweite in digitalen Kanälen.\\\\
Zusammenfassend lässt sich festhalten, dass das Plugin \textit{Charigame} sowohl im \gls{b2b}- als auch im \gls{b2c}-Kontext unterschiedliche Mehrwerte schaffen kann.
Während im \gls{b2b}-Bereich die Aspekte Reputation und Kundenbindung im Vordergrund stehen, sind es im \gls{b2c}-Bereich vor allem Markenerlebnis und Differenzierung, die den Einsatz attraktiv machen.
\end{enumerate}

\section{Anforderungen an die Weiterentwicklung}
Aus den Erkenntnissen der Stakeholderanalyse und den identifizierten Schwächen des deskriptiven Stands, sowie der zu bearbeitenden These dieser Arbeit lassen sich diverse Anforderungen ableiten.
Diese Anforderungen wurden entsprechend dem definierten Projektumfang auf die wesentlichsten Aspekte fokussiert und werden nachfolgend adressiert.

% -------------------------------------------------
% Technische Anforderungen
\subsection{Technische Anforderungen}
\begin{enumerate}[label={[T\arabic*]},ref=T\arabic*]
    \item \label{T1} Das System muss die Abhängigkeit von der PRO-Version des Plugins ACF (Advanced Custom Fields) entfernen.
    \item \label{T2} Das System muss gängige WordPress-Plugin-Best-Practices befolgen.
    \item \label{T3} Das System soll gängige Security-Best-Practices der WordPress-Developer-Ressourcen berücksichtigen.
\end{enumerate}

% -------------------------------------------------
% Funktionale Anforderungen
\subsection{Funktionale Anforderungen}
\begin{enumerate}[label={[F\arabic*]},ref=F\arabic*]
    \item \label{F1} Das System muss die Landingpage mit dem Gutenberg-Editor editierbar machen.
    \item \label{F2} Das System muss Gutenberg-Blöcke bereitstellen, die die bestehende Landingpage abbilden können.
    \item \label{F3} Das System soll eine verbesserte Möglichkeit bieten, Inhalte zu bearbeiten.
    \item \label{F4} Das System kann eine verbesserte Version des Dashboards bereitstellen.
    \item \label{F5} Das System kann eine bessere Übersicht für Nutzer bieten.
\end{enumerate}

\section{Abgrenzung des Projektumfangs}
Zur Abgrenzung des Projektumfangs der Arbeit wurden die Anforderungen im Muss-Kann-Soll-Schema definiert.
Das bestehende Projekt bietet weiterführendes Potenzial wesentlich mehr Anforderungen zu definieren, die nicht abgedeckt wurden, um den Umfang im Rahmen zu halten.
Die definierten Anforderungen werden im weiteren Verlauf der Konzeption tiefergehend betrachtet, damit der angestrebte präskriptive Zustand erreicht wird.

\section{Plugin-Architektur}
Die Weiterentwicklung des Plugins \emph{Charigame} strebt eine modulare und wartungsfreundliche Pluginarchitektur an, wie einleitend in Kapitel \ref{chap:intro} skizziert.
Dabei wird das Ziel verfolgt, eine klare Trennung von Verantwortlichkeiten umzusetzen.
Ferner wird die Erweiterbarkeit und die Möglichkeit, das Projekt skalierbar zu entwickeln, ein wesentlicher Bestandteil der Architektur.
Grundlegend wird ein objektorientierter Ansatz verfolgt, um die Wiederverwendbarkeit des Codes zu gewährleisten.
Folgend werden die wichtigsten definierten Anforderungen im Zusammenhang mit den einzusetzenden Technologien adressiert.
\subsection{Einzusetzende Technologien}
\textbf{Carbon Fields}

Die Abhängigkeit des externen Plugins ACF Pro vollständig zu entfernen, geht aus der zuvor definierten Anforderung [\ref{T1}] hervor.
Anstelle von ACF Pro wird das Framework Carbon Fields genutzt, das über Composer eingebunden werden kann.
Carbon Fields ermöglicht die flexible Definition und Verwaltung von Metafeldern innerhalb von WordPress.
Im Vergleich zu ACF hat diese Lösung den Vorteil, dass sie als Bibliothek in das Plugin integriert werden kann.
Darüber hinaus ist Carbon Fields eine Open Source Lösung und es ist keine kostengebundene Lizenz notwendig.
\\\\
\textbf{Gutenberg Blockeditor}

Ein weiterer Kernbestandteil der Technologieauswahl ist die Integration von Gutenberg.
Dies erlaubt die Entwicklung maßgeschneiderter Blöcke für den Editor und stellt sicher, dass Inhalte direkt im Backend in einer Live-Vorschau bearbeitet werden können.
Für das Editor-UI wird React verwendet, da es die von WordPress empfohlene und im Gutenberg-Editor standardmäßig eingesetzte Technologie ist.
Die Kopplung von PHP im Backend und React im Editor ermöglicht eine klare Trennung von Daten- und Darstellungsschicht.
Durch den Einsatz dieser Lösung können die Anforderungen [\ref{F1}], [\ref{F2}] und [\ref{F3}] behandelt werden.
\\\\
\textbf{PHPCS}

Eine weitere zentrale Thematik der Weiterentwicklung bildet die Anforderung [\ref{T2}].
Unter Zuhilfenahme des \gls{phpcs} wird sichergestellt, dass die Wordpress Coding Standards konsequent eingehalten werden.
Diese Verwendung ermöglicht eine automatisierte Überprüfung des Codes, sodass Verstöße gegen die definierten Standards unmittelbar angezeigt werden.
Auf diese Weise wird nicht nur die Lesbarkeit, sondern auch die langfristige Wartbarkeit des Codes erheblich verbessert.
\\\\
Aus der geplanten Architektur und den eingesetzten Technologien geht weiterführend der Aufbau der Komponenten hervor.

\subsection{Aufbau der Komponenten}
Das Plugin soll eine zentrale Einstiegsklasse \texttt{Charigame} besitzen, die in der Hauptdatei des Plugins initialisiert wird.
Durch den definierten Plugin-Header sowie die Implementierung der WordPress-Hooks für Aktivierung und Deaktivierung wird diese Klasse geladen und stößt die Instanziierung aller weiteren benötigten Abhängigkeiten an.
Die Architektur sieht eine Reihe spezialisierter Klassen vor, welche die unterschiedlichen Funktionsbereiche des Plugins abbilden.
Dazu gehören unter anderem:

\begin{itemize}
    \item \textbf{Charigame Blocks:} Verantwortlich für die Registrierung und Bereitstellung der im Plugin genutzten Gutenberg-Blöcke.
    Darüber hinaus wird eine eigene Block-Kategorie eingeführt und die notwendigen Assets werden eingebunden.
    \item \textbf{Login Handler:} Kümmert sich um die Verwaltung der Loginsessions der Teilnehmer, prüft Gamecodes und stößt das Rendering der Landingpage an.
    \item \textbf{Color Manager:} Ermöglicht die Registrierung von Kampagnenfarben und deren dynamische Integration in das DOM.
    \item \textbf{Donation Manager:} Übernimmt die Logik der Spendenverteilung, speichert und aktualisiert Ergebnisse, berechnet Anteile und stellt diese für die weitere Verarbeitung bereit.
    \item \textbf{Email Sender:} Implementiert Funktionen zum E-Mail-Versand.
    Dazu gehören die Konfiguration des SMTP, das Versenden von Test- und Kampagnenmails, die Generierung des HTML-Templates sowie das Bereitstellen von Variablen.
    \item \textbf{Carbon Fields:} Verantwortlich für die Initialisierung und Bereitstellung des Frameworks Carbon Fields, das zur Verwaltung individueller Metafelder eingesetzt wird.
\end{itemize}

Ergänzend wird eine statische Konfigurationsdatei vorgesehen, die allgemeine Design-Mappings wie Abstände, Textausrichtungen oder Flexbox-Alignments enthält.
Diese statischen Definitionen basieren auf TailwindCSS und werden innerhalb der Gutenberg-Blöcke genutzt.
\newpage
\subsection{Custom Post Types}
Die zentrale Datenstruktur des Plugins wird über die Definition mehrerer Custom Post Types (\gls{CPT}) realisiert.
Folgende Post Types werden vorgesehen:

\begin{itemize}
    \item \textbf{Campaign:} Enthält alle zentralen Informationen einer Kampagne.
    Dazu gehören die Wahl des Spieltyps, spezifische Spieleinstellungen, Verlinkungen zu Landingpages und E-Mail-Templates sowie die Konfigurationen zur Spendenverteilung und der Zeitsteuerung.
    Zudem werden in der Campaign die Einstellungen für das Login-Formular hinterlegt.

    \item \textbf{Landingpage:} Stellt einen CPT zur Verfügung, der die Bearbeitung von Landingpages direkt im Gutenberg-Editor ermöglicht.
    \item \textbf{Game:} Dient als Zuordnungstyp für die verschiedenen im Plugin angebotenen Spiele.
    \item \textbf{Game-Settings:} Wird als neuer CPT erstellt, der die Spieleinstellungen aus der Kampagne nimmt und diese wiederverwendbar macht.
    \item \textbf{Recipient:} Enthält Informationen zu den begünstigten Empfängern einer Kampagne, darunter Name, Logo und Beschreibung.
    \item \textbf{User:} Speichert Teilnehmendeninformationen wie Vorname, Nachname, E-Mail-Adresse und Geburtsdatum.
    Außerdem werden hier Import- und E-Mail-Versand-Status dokumentiert.
    Die ursprüngliche Implementierung mit ACF wird durch Carbon Fields ersetzt.
    \item \textbf{Email Template:} Ermöglicht die Verwaltung von E-Mail-Templates innerhalb des Gutenberg-Editors.
\end{itemize}

Die verwendeten Custom Post Types, stehen wie in Abbildung~\ref{fig:datenmodell} visualisiert, in Relation zueinander.
Hier ist ersichtlich, dass die Campaign als zentraler Punkt die diversen Custom Post Types nutzt, um alle notwendigen Informationen für die Spendenkampagne zu aggregieren.
Zudem kann man erkennen, dass das geplante Dashboard die Daten aus der Kampagne und den Nutzern bezieht und diese durch weitere Parameter anreichert.
\begin{figure}[H]
    \centering
    \includesvg[width=1.0\textwidth]{images/datenmodell}
    \caption{Relation der Custom Post Types (eigene Darstellung)}
    \label{fig:datenmodell}
\end{figure}


\subsection{Verwaltungs- und Darstellungsebene}
Für den Administrationsbereich ist die Bereitstellung eines eigenen Dashboards geplant, das als zentrales Menü im WordPress-Backend integriert wird.
Dieses ersetzt die bisherige Lösung, die auf Data Tables basierte und stellt eine intuitivere Verwaltung der Kampagneninhalte bereit und adressiert die Anforderung [\ref{F4}] und [\ref{F5}].

Im Frontend-Bereich wird ein Template Loader eingesetzt, der die Darstellung der Campaign- und Landingpage-Inhalte übernimmt.
Zusätzlich steuert ein Asset Manager das Einbinden und Entfernen aller benötigten Skripte und Styles, wie beispielsweise backend.js.

Ergänzend zur Trennung von Frontend und Backend ist ein dedizierter Helper-Layer vorgesehen.
Dieser beinhaltet eine Helper-Komponente, die verschiedene serverseitige Funktionen bereitstellt.
Dazu gehören unter anderem die Registrierung von \gls{ajax}-Actions sowie öffentliche Methoden zur Abfrage von Spendenverteilungen oder zur Verwaltung aggregierter Kampagnenergebnisse.
Die Trennung in einen dedizierten Layer ermöglicht es, wiederkehrende Aufgaben zentral zu verwalten.
%\\\\
%\textbf{Datenmodell der Klassen}


%Geplante Struktur bietet bessere Wartbarkeit blabla
%Die Struktur erlaubt Redakteuren die Pflege mit vertrauten WP-Mechanismen; Ent-
%wickler profitieren von einer sauberen Trennung von Geschäftslogik und Präsentati-
%on.
%
%Dann gutenberg blabla
%Keine stanni blöcke, um den fokus auf die wesentlichen und erklären warum man weniger optionen bieten sollte
%Dann Farben und Abstände regulieren das ganze mit Tailwind als CSS, sodass keine eigene blockcss notwendig ist
%Blöcke maßgeblich statisch programmiert also mit allen möglichen elementen die der block vorgesehen hat aber alles anpassbar individualisierbar
%bei how-to auch das Paradigma der blöcke mit innerblocks umgesetzt.
%dann noch nicht aufnehmen game-settings
%Dann extra bonus block-design für Email TEmplate aufgebaut --
